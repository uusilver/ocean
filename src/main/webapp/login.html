<%@ page language="java" pageEncoding="UTF-8"%>
<%@ page contentType="text/html;charset=UTF-8" %>
<%@ page session="false" %>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>用户登录注册-快查</title>
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon"/>
    <meta name="keywords" content="用户登录注册-3•15快查" />
    <meta name="description" content="用户登录注册-3•15快查" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <!-- basic styles -->

    <link href="bootstrap/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="bootstrap/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!--[if IE 7]>
    <link rel="stylesheet" href="assets/css/font-awesome-ie7.min.css"/>
    <![endif]-->

    <!-- page specific plugin styles -->

    <!-- fonts -->


    <!-- ace styles -->

    <link rel="stylesheet" href="bootstrap/assets/css/ace.min.css"/>
    <link rel="stylesheet" href="bootstrap/assets/css/ace-rtl.min.css"/>

    <!--[if lte IE 8]>
    <link rel="stylesheet" href="assets/css/ace-ie.min.css"/>
    <![endif]-->

    <!-- inline styles related to this page -->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->

    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <script src="js/jquery.js"></script>
    <script>
        $(function () {
            var url = window.location.url;
            var tag = url.split("?")[1];
            alert("13");
            if (tag == "1") {
                alert("用户名，密码错误，请检查");
            }

            if (tag == "2") {
                alert("用户被暂停，请联系您的代理商");
            }
        });
    </script>
    <![endif]-->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>

<body class="login-layout">
<div class="main-container">
    <div class="main-content">
        <div class="row">
            <div class="col-sm-10 col-sm-offset-1">
                <div class="login-container">
                    <div class="center">
                        <h1>
                            <i class="icon-qrcode white"></i>
                            <span class="red">3•15快查</span>
                            <span class="white">315KC.COM</span></h1>
                        <h4 class="blue">&copy; 快查信息大数据处理云平台</h4>
                    </div>

                    <div class="space-6"></div>

                    <div class="position-relative">
                        <div id="login-box" class="login-box visible widget-box no-border">
                            <div class="widget-body">
                                <div class="widget-main">
                                    <h4 class="header blue lighter bigger">
                                        <i class="icon-coffee green"></i>
                                        请输入你的用户名和密码 </h4>

                                    <div class="space-6"></div>

                                    <form id="loginForm" method="post" action="login?weblogin">
                                        <fieldset>
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="text" class="form-control" name="username"
                                                                   id="username" required="true" placeholder="用户名">
															<i class="icon-user"></i>														</span>
                                            </label>

                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="password" class="form-control" name="password"
                                                                   required="true" id="password" placeholder="密码">
															<i class="icon-lock"></i>														</span>
                                            </label>

                                            <!-- 验证码-->
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input name="j_code" type="text"placeholder="验证码" id="j_code" maxlength="4" class="form-control" />
															<br/>
                                                               <img id="kaptchaImage" alt="验证码" src="login/code"/><br/>
                                                               <a href="#" onclick="changeCode()">看不清?换一张</a><br/>
                                                               <span id="jcodeMsg"></span>
                                                        </span>
                                            </label>

                                            <div class="space"></div>

                                            <div class="clearfix">
                                                <label class="inline">
                                                    <input id="rememberMe" type="checkbox" class="ace"/>
                                                    <span class="lbl"> 记住我登录</span> </label>

                                                <button type="button" id="loginIn"
                                                        class="width-35 pull-right btn btn-sm btn-primary">
                                                    <i class="icon-key"></i>
                                                    登陆
                                                </button>
                                            </div>

                                            <div class="space-4"></div>
                                        </fieldset>
                                    </form>


                                </div>
                                <!-- /widget-main -->

                                <div class="toolbar clearfix">
                                    <div>
                                        <a href="#" onClick="show_box('forgot-box'); return false;"
                                           class="forgot-password-link">
                                            <i class="icon-arrow-left"></i>
                                            忘记密码 </a></div>

                                    <!--<div>-->
                                    <!--<a href="#" onClick="show_box('signup-box'); return false;" class="user-signup-link">-->
                                    <!--注册用户名-->
                                    <!--<i class="icon-arrow-right"></i>										</a>									</div>-->
                                </div>
                            </div>
                            <!-- /widget-body -->
                        </div>
                        <!-- /login-box -->

                        <div id="forgot-box" class="forgot-box widget-box no-border">
                            <div class="widget-body">
                                <div class="widget-main">
                                    <h4 class="header red lighter bigger">
                                        <i class="icon-key"></i>
                                        在线密码找回 </h4>

                                    <div class="space-6"></div>
                                    <p>
                                        请输入你的注册邮箱找回密码 </p>

                                    <form>
                                        <fieldset>
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="text" class="form-control" id="username1"
                                                                   placeholder="用户名"/>
															<i class="icon-envelope"></i>														</span>
                                            </label>
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="email" class="form-control" id="email1"
                                                                   placeholder="邮箱地址"/>
															<i class="icon-envelope"></i>														</span>
                                            </label>

                                            <div class="clearfix">
                                                <button id="getNewPass" type="button" class="width-35 pull-right btn btn-sm btn-danger">
                                                    <i class="icon-lightbulb"></i>
                                                    发送找回!
                                                </button>
                                            </div>
                                        </fieldset>
                                    </form>
                                </div>
                                <!-- /widget-main -->

                                <div class="toolbar center">
                                    <a href="#" onClick="show_box('login-box'); return false;"
                                       class="back-to-login-link">
                                        返回登陆界面
                                        <i class="icon-arrow-right"></i> </a></div>
                            </div>
                            <!-- /widget-body -->
                        </div>
                        <!-- /forgot-box -->

                        <div id="signup-box" class="signup-box widget-box no-border">
                            <div class="widget-body">
                                <div class="widget-main">
                                    <h4 class="header green lighter bigger">
                                        <i class="icon-group blue"></i>
                                        新用户注册 </h4>

                                    <div class="space-6"></div>
                                    <p> 注册开始 </p>

                                    <form>
                                        <fieldset>
                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="email" class="form-control" placeholder="邮箱"/>
															<i class="icon-envelope"></i>														</span>
                                            </label>

                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="text" class="form-control" placeholder="用户名"/>
															<i class="icon-user"></i>														</span>
                                            </label>

                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="password" class="form-control"
                                                                   placeholder="密码"/>
															<i class="icon-lock"></i>														</span>
                                            </label>

                                            <label class="block clearfix">
														<span class="block input-icon input-icon-right">
															<input type="password" class="form-control"
                                                                   placeholder="再次确认密码"/>
															<i class="icon-retweet"></i>														</span>
                                            </label>

                                            <label class="block">
                                                <input type="checkbox" class="ace"/>
														<span class="lbl">
															我认同平台此项
															<a href="#">服务条款</a>														</span>
                                            </label>

                                            <div class="space-24"></div>

                                            <div class="clearfix">
                                                <button type="reset" class="width-30 pull-left btn btn-sm">
                                                    <i class="icon-refresh"></i>
                                                    重写
                                                </button>

                                                <button type="button"
                                                        class="width-65 pull-right btn btn-sm btn-success">
                                                    注册
                                                    <i class="icon-arrow-right icon-on-right"></i></button>
                                            </div>
                                        </fieldset>
                                    </form>
                                </div>

                                <div class="toolbar center">
                                    <a href="#" onClick="show_box('login-box'); return false;"
                                       class="back-to-login-link">
                                        <i class="icon-arrow-left"></i>
                                        返回登录界面 </a></div>
                            </div>
                            <!-- /widget-body -->
                        </div>
                        <!-- /signup-box -->
                    </div>
                    <!-- /position-relative -->
                </div>
            </div>
            <!-- /.col -->
        </div>
        <!-- /.row -->
    </div>
</div>
<!-- /.main-container -->

<!-- basic scripts -->

<!--[if !IE]> -->


<!-- <![endif]-->


<![endif]-->

<!--[if !IE]> -->

<script type="text/javascript">
    window.jQuery || document.write("<script src='bootstrap/assets/js/jquery-2.0.3.min.js'>" + "<" + "/script>");
</script>

<!-- <![endif]-->

<!--[if IE]>
<script type="text/javascript">
    window.jQuery || document.write("<script src='assets/js/jquery-1.10.2.min.js'>" + "<" + "/script>");
</script>
<![endif]-->

<script type="text/javascript">
    if ("ontouchend" in document) document.write("<script src='bootstrap/assets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
</script>

<!-- inline scripts related to this page -->

<script type="text/javascript">
    function show_box(id) {
        jQuery('.widget-box.visible').removeClass('visible');
        jQuery('#' + id).addClass('visible');
    }
</script>
</div>
</body>
<script src="js/jquery.js"></script>
<script src="js/jquery.cookie.js"></script>
<script>

    $(function () {
        document.onkeydown = function (event){
            if (event.keyCode==13) //回车键的键值为13
                $("#loginIn").trigger("click");
        };
        //登陆
        $("#loginIn").click(function(){
            var jcodeVal = $("#j_code").val();
            if(jcodeVal){
                $.post("login/validateJCode",{jCode:jcodeVal},function(data){
                    if(data=="success"){
                        $("#loginForm").submit();
                    }else{
                        //显示错误信息
                        $("#jcodeMsg").html("<span style='color: red; font-weight: bold;'>验证码错误</span>");
                        //清空
                        $("#j_code").val('');
                        //重新生成
                        $("#kaptchaImage").trigger('click');
                    }
                })
            }else{
                alert("请填写验证码");
            }
        });

        if ($.cookie('315kc_ocean_userName') != undefined) {
            $("#rememberMe").attr("checked", true);
        } else {
            $("#rememberMe").attr("checked", false);
        }

        //读取cookie
        if ($('#rememberMe:checked').length > 0) {
            $('#username').val($.cookie('315kc_ocean_userName'));
            $('#password').val($.cookie('315kc_ocean_password'));
        }

        //监听【记住我】事件
        $("#rememberMe").click(function () {
            if ($('#rememberMe:checked').length > 0) {//设置cookie
                $.cookie('315kc_ocean_userName', $('#username').val());
                $.cookie('315kc_ocean_password', $('#password').val());
            } else {//清除cookie
                $.removeCookie('315kc_ocean_userName');
                $.removeCookie('315kc_ocean_password');
            }
        });

        $("#getNewPass").click(function(){
            $.post("login/getNewPass",
                    {
                        username:$("#username1").val(),
                        email: $("#email1").val(),
                    },
                function(data){
                    if(data=="success"){
                        alert("密码重置成功!");
                        window.location.reload();
                    }
                }
            )
        });

        $('#kaptchaImage').click(function () {//生成验证码
            $(this).hide().attr('src', 'login/code?' + Math.floor(Math.random()*100) ).fadeIn();
            event.cancelBubble=true;
        });
    });

    window.onbeforeunload = function(){
        //关闭窗口时自动退出
        if(event.clientX>360&&event.clientY<0||event.altKey){
            alert(parent.document.location);
        }
    };

    //改变验证码
    function changeCode() {
        $('#kaptchaImage').hide().attr('src', 'login/code?' + Math.floor(Math.random()*100) ).fadeIn();
        event.cancelBubble=true;
    }

//        function changeImg() {
//            var imgSrc = $("#imgObj");
//            var src = imgSrc.attr("src");
//            imgSrc.attr("src", chgUrl(src));
//        }
//        //时间戳
//        //为了使每次生成图片不一致，即不让浏览器读缓存，所以需要加上时间戳
//        function chgUrl(url) {
//            var timestamp = (new Date()).valueOf();
//            url = url.substring(0, 17);
//            if ((url.indexOf("&") >= 0)) {
//                url = url + "×tamp=" + timestamp;
//            } else {
//                url = url + "?timestamp=" + timestamp;
//            }
//            return url;
//        }
</script>
</html>